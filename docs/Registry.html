<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>Registry. batchtools 0.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">batchtools 0.1</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="reference.html">Reference</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <div class="container">
      <header>
        
      </header>
      
      <h1>Registry Constructor</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='Registry.html'>makeRegistry</a></span><span class="keyword">(</span><span class="argument">file.dir</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="string">"registry"</span><span class="keyword">,</span> <span class="argument">work.dir</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/getwd'>getwd</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="argument">conf.file</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall">findConfFile</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">packages</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/character'>character</a></span><span class="keyword">(</span><span class="number">0L</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="argument">namespaces</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/character'>character</a></span><span class="keyword">(</span><span class="number">0L</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">source</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/character'>character</a></span><span class="keyword">(</span><span class="number">0L</span><span class="keyword">)</span><span class="keyword">,</span>
  <span class="argument">load</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/character'>character</a></span><span class="keyword">(</span><span class="number">0L</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">seed</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span> <span class="argument">make.default</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">TRUE</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>getDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>setDefaultRegistry</a></span><span class="keyword">(</span><span class="symbol">reg</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>clearDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>loadRegistry</a></span><span class="keyword">(</span><span class="argument">file.dir</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/getwd'>getwd</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">work.dir</span>&nbsp;<span class="argument">=</span>&nbsp;NULL<span class="keyword">,</span>
  <span class="argument">conf.file</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall">findConfFile</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">make.default</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">update.paths</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="number">FALSE</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>saveRegistry</a></span><span class="keyword">(</span><span class="argument">reg</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='Registry.html'>getDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>sweepRegistry</a></span><span class="keyword">(</span><span class="argument">reg</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='Registry.html'>getDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>clearRegistry</a></span><span class="keyword">(</span><span class="argument">reg</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='Registry.html'>getDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span>

<span class="functioncall"><a href='Registry.html'>syncRegistry</a></span><span class="keyword">(</span><span class="argument">reg</span>&nbsp;<span class="argument">=</span>&nbsp;<span class="functioncall"><a href='Registry.html'>getDefaultRegistry</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>file.dir</dt>
      <dd>[<code>character(1)</code>]
  Path where all files of the registry are saved.
  Default is directory &#147;registry&#148; in the current working directory.
  The provided path will get normalized unless it is given relative to the home directory
  (i.e., starting with &#147;~&#148;). Note that some templates do not handle relative paths well.

  If you pass <code>NA</code>, a temporary directory will be used.
  This way, you can create disposable registries for <code><a href='btlapply.html'>btlapply</a></code> or examples.
  By default, the temporary directory <code><a href='http://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a>()</code> will be used.
  If you want to use another directory, e.g. a directory which is shared between nodes,
  you can set it in your configuration file by setting the variable <code>temp.dir</code>.</dd>
      <dt>work.dir</dt>
      <dd>[<code>character(1)</code>]
  Working directory for R process for running jobs.
  Defaults to the working directory currently set during Registry construction (see <code><a href='http://www.rdocumentation.org/packages/base/topics/getwd'>getwd</a></code>).
  <code>loadRegistry</code> uses the stored <code>work.dir</code>, but you may also explicitly overwrite it,
  e.g., after switching to another system.

  The provided path will get normalized unless it is given relative to the home directory
  (i.e., starting with &#147;~&#148;). Note that some templates do not handle relative paths well.</dd>
      <dt>conf.file</dt>
      <dd>[<code>character(1)</code>]
Path to a configuration file which is sourced directly after the registry is created.
For example, you can set cluster functions or default resources in it.
The script is executed inside the registry environment, thus you can directly set
all slots, e.g. <code>default.resources = list(walltime = 3600)</code> to set default resources.
Defaults to a heuristic which first looks for &#147;batchtools.conf.R&#148; in the current working directory
and then tries &#147;.batchtools.conf.R&#148; in the home directory.
Set to <code>character(0)</code> if you want to disable this lookup.</dd>
      <dt>packages</dt>
      <dd>[<code>character</code>]
Packages that will always be loaded on each node.
Uses <code><a href='http://www.rdocumentation.org/packages/base/topics/library'>require</a></code> internally.
Default is <code>character(0)</code>.</dd>
      <dt>namespaces</dt>
      <dd>[<code>character</code>]
Same as <code>packages</code>, but the packages will not be attached.
Uses <code><a href='http://www.rdocumentation.org/packages/base/topics/ns-load'>requireNamespace</a></code> internally.
Default is <code>character(0)</code>.</dd>
      <dt>source</dt>
      <dd>[<code>character</code>]
Files which should be sourced on the slaves prior to executing a job.
Calls <code><a href='http://www.rdocumentation.org/packages/base/topics/sys.source'>sys.source</a></code> using the <code><a href='http://www.rdocumentation.org/packages/base/topics/environment'>.GlobalEnv</a></code>.</dd>
      <dt>load</dt>
      <dd>[<code>character</code>]
Files which should be loaded on the slaves prior to executing a job.
Calls <code><a href='http://www.rdocumentation.org/packages/base/topics/load'>load</a></code> using the <code><a href='http://www.rdocumentation.org/packages/base/topics/environment'>.GlobalEnv</a></code>.</dd>
      <dt>seed</dt>
      <dd>[<code>integer(1)</code>]
Start seed for jobs. Each job uses the (<code>seed</code> + <code>job.id</code>) as seed.
Default is a random number in the range [1, <code>.Machine$integer.max/2</code>].</dd>
      <dt>make.default</dt>
      <dd>[<code>logical(1)</code>]
If set to <code>TRUE</code>, the created registry is saved inside the package
namespace and acts as default registry. You might want to switch this
off if you work with multiple registries simultaneously.
Default is <code>TRUE</code>.</dd>
      <dt>reg</dt>
      <dd>[<code><a href='Registry.html'>Registry</a></code>]
Registry. If not explicitly passed, uses the last created registry.</dd>
      <dt>update.paths</dt>
      <dd>[<code>logical(1)</code>]
If set to <code>TRUE</code>, the <code>file.dir</code> and <code>work.dir</code> will be updated in the registry. Note that this is
likely to break computation on the system! Only do this if no jobs are currently running. Default is <code>FALSE</code>.
If the provided <code>file.dir</code> does not match the stored <code>file.dir</code>, <code>loadRegistry</code> will return a
registry in read-only mode.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
[<code>Registry</code>]. An environment with the following slots:
  <dl>
    <dt><code>file.dir</code> [path]:</dt><dd>File directory.</dd></p>

      <p><dt><code>work.dir</code> [path]:</dt><dd>Working directory.</dd></p>

      <p><dt><code>temp.dir</code> [path]:</dt><dd>Temporary directory. Used if <code>file.dir</code> is <code>NA</code>.</dd></p>

      <p><dt><code>packages</code> [character()]:</dt><dd>Packages to load on the slaves.</dd></p>

      <p><dt><code>namespaces</code> [character()]:</dt><dd>Namespaces to load on the slaves.</dd></p>

      <p><dt><code>seed</code> [integer(1)]:</dt><dd>Registry seed. Before each job is executed, the seed <code>seed + job.id</code> is set.</dd></p>

      <p><dt><code>cluster.functions</code> [cluster.functions]:</dt><dd>Usually set in your <code>conf.file</code>. Set via a call to <code><a href='makeClusterFunctions.html'>makeClusterFunctions</a></code>. See example.</dd></p>

      <p><dt><code>default.resources</code> [named list()]:</dt><dd>Usually set in your <code>conf.file</code>. Named list of default resources.</dd></p>

      <p><dt><code>max.concurrent.jobs</code> [integer(1)]:</dt><dd>Usually set in your <code>conf.file</code>. Maximum number of concurrent jobs for a single user on the system. <code><a href='submitJobs.html'>submitJobs</a></code> will try to respect this setting.</dd></p>

      <p><dt><code>defs</code> [data.table]:</dt><dd>Table with job definitions (i.e. parameters).</dd></p>

      <p><dt><code>status</code> [data.table]:</dt><dd>Table holding information about the computational status. Also see <code><a href='getJobTable.html'>getJobStatus</a></code>.</dd></p>

      <p><dt><code>resources</code> [data.table]:</dt><dd>Table holding information about the computational resources used for the job. Also see <code><a href='getJobTable.html'>getJobResources</a></code>.</dd></p>

      <p><dt><code>tags</code> [data.table]:</dt><dd>Table holding information about tags. See <a href='Tags.html'>Tags</a>.</dd></p>

      <p></dl></p>

      <p></dl></p>

    </div>

    <div class="Description">
      <h2>Description</h2>

      <p><code>makeRegistry</code> constructs the inter-communication object for all functions in <code>batchtools</code>.
All communication transactions are processed via the file system:
All information required to run a job is stored as <code><a href='JobCollection.html'>JobCollection</a></code> in a file in the
a subdirectory of the <code>file.dir</code> directory.
Each jobs stores its results as well as computational status information (start time, end time, error message, ...)
also on the file system which is regular merged parsed by the master using <code>syncRegistry</code>.
After integrating the new information into the Registry, the Registry is serialized to the file system via <code>saveRegistry</code>.
Both <code>syncRegistry</code> and <code>saveRegistry</code> are called whenever required internally.
Therefore it should be safe to quit the R session at any time.
Work can later be resumed by calling <code>loadRegistry</code> which de-serializes the registry from
the file system.</p>

      <p>The registry created last is saved in the package namespace (unless <code>make.default</code> is set to
<code>FALSE</code>) and can be retrieved via <code>getDefaultRegistry</code>.</p>

      <p>Canceled jobs and repeatedly submitted jobs may leave stray files behind.
These can be swept using <code>sweepRegistry</code>.
<code>clearRegistry</code> completely erases all jobs from a registry, including log files and results,
and thus allows you to start over.</p>

    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="symbol">tmp</span> <span class="assignement">=</span> <span class="functioncall"><a href='Registry.html'>makeRegistry</a></span><span class="keyword">(</span><span class="argument">file.dir</span> <span class="argument">=</span> <span class="number">NA</span><span class="keyword">,</span> <span class="argument">make.default</span> <span class="argument">=</span> <span class="number">FALSE</span><span class="keyword">)</span></div>
<strong class='message'>Sourcing configuration file &#39;~/.batchtools.conf.R&#39; ...</strong>
<div class='input'><span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/print'>print</a></span><span class="keyword">(</span><span class="symbol">tmp</span><span class="keyword">)</span></div>
<div class='output'>Job Registry
  ClusterFunctions: Interactive
  File dir        : /scratch/registry2b2630afdce1
  Work dir        : /home/lang/Projekte/packages/batchtools
  Jobs            : 0
  Seed            : 985706415
</div>
<div class='input'>
<span class="comment"># Set cluster functions to interactive mode and start jobs in external R sessions</span>
<span class="symbol">tmp</span><span class="keyword">$</span><span class="symbol">cluster.functions</span> <span class="assignement">=</span> <span class="functioncall"><a href='makeClusterFunctionsInteractive.html'>makeClusterFunctionsInteractive</a></span><span class="keyword">(</span><span class="argument">external</span> <span class="argument">=</span> <span class="number">TRUE</span><span class="keyword">)</span>

<span class="comment"># Change packages to load</span>
<span class="symbol">tmp</span><span class="keyword">$</span><span class="symbol">packages</span> <span class="assignement">=</span> <span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="string">"MASS"</span><span class="keyword">)</span>
<span class="functioncall"><a href='Registry.html'>saveRegistry</a></span><span class="keyword">(</span><span class="argument">reg</span> <span class="argument">=</span> <span class="symbol">tmp</span><span class="keyword">)</span></div></pre>
  </div>
  <div class="span4 sidebar">
    <!-- <ul>
      <li>Registry</li><li>clearDefaultRegistry</li><li>clearRegistry</li><li>getDefaultRegistry</li><li>loadRegistry</li><li>makeRegistry</li><li>saveRegistry</li><li>setDefaultRegistry</li><li>sweepRegistry</li><li>syncRegistry</li>
    </ul>
    <ul>
      
    </ul> -->




  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="https://getbootstrap.com/2.0.4/">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>